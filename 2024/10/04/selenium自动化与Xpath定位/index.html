<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#3367D6"/>
  <link rel="apple-touch-icon" href="/icons-192.png">
  <link rel="manifest" href="/manifest.json">
  
  <meta name="generator" content="Hexo 7.3.0">

  
    <meta name="description" content="Zhou">
  

  

  
    <meta name="author" content="ChengZhou">
  

  

  

  <title>selenium自动化与Xpath定位 | XiaoZhou</title>

  

  
    <link rel="shortcut icon" href="/favicon.ico">
  

  

  

  

  
<link rel="stylesheet" href="/css/style.css">

</head>
<body>
  <div class="root-container">
    
<!-- header container -->
<header class="header-container post">
  
    <div class="post-image" style="background-image: url(https://qiniu.sukoshi.xyz/src/images/68686407_p0.jpg)"></div>
  

  <!-- navbar -->
<nav class="navbar">
  <div class="navbar-content">
    <!-- logo -->
    <div class="navbar-logo">
      <a href="/">
        
          XiaoZhou
        
      </a>
    </div>
    <!-- link -->
    <div class="navbar-link">
      <div class="navbar-btn">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul class="navbar-list">
        
          <li class="navbar-list-item"><a href="/">首页</a></li>
        
          <li class="navbar-list-item"><a href="/archives">归档</a></li>
        
          <li class="navbar-list-item"><a href="/links">友链</a></li>
        
          <li class="navbar-list-item"><a href="/about">关于</a></li>
        
      </ul>
    </div>
  </div>
</nav>

  
  

  
  

  
  

  
  

  
  
    <div class="header-content">
      <div class="post-text layout-block">
        <div class="layout-margin">
          <h1 class="title-wrap">selenium自动化与Xpath定位</h1>
          <h2 class="title-sub-wrap">
            <strong>ChengZhou</strong>
            <span>发布于</span>
            <time  class="article-date" datetime="2024-10-04T12:47:54.000Z" itemprop="datePublished">2024-10-04</time>
          </h2>
          
          
          <ul class="wrap-list dark">
  
</ul>
          <ul class="wrap-list dark">
  
    <li><a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96/">🏷️ 浏览器自动化</a></li>
  
</ul>
        </div>
      </div>
    </div>
  

  
  
  
</header>

    <!-- 文章 -->

<!-- 文章内容 -->
<div class="body-container">
  <article class="content-container layout-block post-container">
    <div class="article-info">
      
      
      
      
      <section class="article-entry markdown-body layout-margin content-padding--large soft-size--large soft-style--box">
        <h1><span id="一-元素定位">一、元素定位</span></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">复制from selenium import webdriver</span><br><span class="line">import time</span><br><span class="line">br = webdriver.Chrome()</span><br><span class="line">br.get(&#x27;http://www.baidu.com&#x27;)</span><br><span class="line"></span><br><span class="line"># 已知网页内容：</span><br><span class="line">&quot;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">  &lt;body link=&quot;#0000cc&quot;&gt;</span><br><span class="line">    &lt;a id=&quot;result_logo&quot; href=&quot;/&quot; onmousedown=&quot;return c(&#123;&#x27;fm&#x27;:&#x27;tab&#x27;,&#x27;tab&#x27;:&#x27;logo&#x27;&#125;)&quot;&gt;</span><br><span class="line">    &lt;form id=&quot;form&quot; class=&quot;fm&quot; name=&quot;f&quot; action=&quot;/s&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;soutu-btn&quot;&gt;&lt;/span&gt;</span><br><span class="line">        &lt;input id=&quot;kw&quot; class=&quot;s_ipt&quot; name=&quot;wd&quot; value=&quot;&quot; maxlength=&quot;255&quot; autocomplete=&quot;off&quot;&gt;</span><br><span class="line">&quot;</span><br><span class="line"># 通过元素id定位</span><br><span class="line">br.find_element_by_id(&#x27;kw&#x27;)</span><br><span class="line"></span><br><span class="line"># 通过元素name定位</span><br><span class="line">br.find_element_by_name(&#x27;wd&#x27;)</span><br><span class="line"></span><br><span class="line"># 通过xpath表达式定位</span><br><span class="line">br.find_element_by_xpath(&#x27;//*[@id=&#x27;kw&#x27;]&#x27;)</span><br><span class="line">    # 查找最后一个数据&quot;//div[last()]&quot;</span><br><span class="line">xpath相关语法：https://www.cnblogs.com/jackzz/p/9125764.html</span><br><span class="line">      </span><br><span class="line"># 通过完整超链接定位</span><br><span class="line">br.find_element_by_link_text(&#x27;&#x27;)</span><br><span class="line"># 通过部分链接定位</span><br><span class="line">br.find_element_by_partial_link_text(&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">#通过标签定位</span><br><span class="line">br.find_element_by_tag_name(&#x27;input&#x27;)</span><br><span class="line"></span><br><span class="line"># 通过类名进行定位</span><br><span class="line">br.find_element_by_class_name(&#x27;s_ipt&#x27;)</span><br><span class="line"></span><br><span class="line"># 通过css选择器进行定位</span><br><span class="line">br.find_element_by_css_selector(&#x27;#kw&#x27;)</span><br><span class="line">br.find_element_by_css_selector(&#x27;.s_ipt&#x27;)</span><br><span class="line"></span><br><span class="line"># 二次定位</span><br><span class="line">tr.find_element_by_xpath(&#x27;.//i[contains(@class, &quot;icon-text-mod__time___3lKrq&quot;)]&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="xpath常用模糊模糊匹配">Xpath常用模糊模糊匹配</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">复制# 这句话的意思是寻找页面中href属性值包含有logout这个单词的所有a元素，其中@后面可以跟该元素任意的属性名。</span><br><span class="line">driver.findElement(By.xpath(&quot;//a[contains(@href, &#x27;logout&#x27;)]&quot;));</span><br><span class="line"></span><br><span class="line"># 这句的意思是寻找rel属性以nofo开头的a元素。其中@后面的rel可以替换成元素的任意其他属性。</span><br><span class="line">driver.findElement(By.xpath(&quot;//a[starts-with(@rel, &#x27;nofo&#x27;)])&quot;);  # 开头</span><br><span class="line">driver.findElement(By.xpath(&quot;//a[ends-with(@rel, &#x27;nofo&#x27;)])&quot;);    # 结尾</span><br><span class="line"># 当浏览器不识别改名了时：</span><br><span class="line">//span[substring(@class, string-length(@class) - string-length(&#x27;cell&#x27;) +1) = &#x27;cell&#x27;]</span><br><span class="line">                   </span><br><span class="line"></span><br><span class="line"># 这种方法也经常用于纯文字的查找。另外，如果知道超链接元素的文本内容，也可以用</span><br><span class="line">driver.findElement(By.xpath(&quot;//*[text()=&#x27;退出&#x27;])&quot;);</span><br><span class="line"></span><br><span class="line"># 这种方式一般用于知道超链接上显示的部分或全部文本信息时，可以使用。</span><br><span class="line">driver.findElement(By.xpath(&quot;//a[contains(text(), &#x27;退出&#x27;)])&quot;);</span><br><span class="line">                   </span><br><span class="line"># 表否定加not即可</span><br><span class="line">//input[@name=‘identity’ and not(contains(@class,‘a’))] </span><br><span class="line">                   </span><br><span class="line"># 匹配符合条件的第几个标签</span><br><span class="line">(//span[contains(@title, &#x27;颜色&#x27;)])[2]</span><br><span class="line">                   </span><br><span class="line"># 取符合条件的最后一个</span><br><span class="line">//li[contains(text(), &#x27;天津&#x27;) and position()=last()]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1><span id="二-模块常用方法">二、模块常用方法</span></h1><h2><span id="1-浏览器操作">1、 浏览器操作</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">复制# 设置浏览器大小</span><br><span class="line">driver.set_window_size()</span><br><span class="line"># 控制浏览器后退</span><br><span class="line">br.back()</span><br><span class="line"># 控制浏览器前进</span><br><span class="line">br.forward()</span><br><span class="line"># 刷新当前页面</span><br><span class="line">br.refresh()</span><br><span class="line"># 清除文本</span><br><span class="line">br.clear()</span><br><span class="line"># 模拟按键输入</span><br><span class="line">br.send_keys(&#x27;xiaozhou&#x27;)</span><br><span class="line"># 点击元素</span><br><span class="line">br.click()</span><br><span class="line"># 提交表单</span><br><span class="line">br.submit()</span><br><span class="line"># 获取元素的属性值</span><br><span class="line">br.get_attribute(name)</span><br><span class="line"># 该元素用户是否可见</span><br><span class="line">br.is_displayed()</span><br><span class="line"># 刷新页面</span><br><span class="line">driver.refresh()</span><br><span class="line"># 打开一个新的窗口</span><br><span class="line">js=&#x27;window.open(&quot;https://www.baidu.com&quot;);&#x27; #通过执行js，开启一个新的窗口</span><br><span class="line">driver.execute_script(js)</span><br><span class="line"></span><br><span class="line"># 通过网页链接选择日期和下拉框，目前支持渠道：万相台，直通车，品销宝，引力魔方</span><br><span class="line">dr.get(&#x27;https://subway.simba.taobao.com/#!/report/bpreport/index?page=1&amp;start=&#x27;+starttimestr+&#x27;&amp;end=&#x27;+endtimestr+&#x27;&amp;effect=1&#x27;)</span><br><span class="line"></span><br><span class="line"># 获得当前页面的宽高</span><br><span class="line">nowpagewidth = dr.execute_script(&quot;return document.documentElement.scrollWidth&quot;)</span><br><span class="line">nowpageheight = dr.execute_script(&quot;return document.documentElement.scrollHeight&quot;)</span><br><span class="line"></span><br><span class="line"># 获取当前窗口大小</span><br><span class="line">self.driver.get_window_size()</span><br><span class="line"></span><br><span class="line"># 设置超时时间</span><br><span class="line">self.driver.set_page_load_timeout(10)</span><br><span class="line"># 设置超时则停止加载</span><br><span class="line">try:</span><br><span class="line">    self.driver.switch_to.window(self.driver.window_handles[1])</span><br><span class="line">except:</span><br><span class="line">    time.sleep(2)</span><br><span class="line">    self.driver.execute_script(&#x27;window.stop()&#x27;)</span><br><span class="line"></span><br><span class="line"># 超时报错</span><br><span class="line">time_start = time.time()</span><br><span class="line">if (time.time() - time_start) &gt; 8:</span><br><span class="line">    raise Exception(&quot;响应超时&quot;)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"># 获取普通元素的文本</span><br><span class="line">br.text()</span><br><span class="line"># 获取非标准的文本内容</span><br><span class="line">driver.find_element_by_xpath(&quot;./tr[1]/th[2]&quot;).get_attribute(&quot;textContent&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="2-鼠标事件">2、鼠标事件</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">复制# 构造ActionChains对象</span><br><span class="line">act = ActionChains(driver)</span><br><span class="line"># 鼠标右击</span><br><span class="line">act.context_click()</span><br><span class="line"># 双击</span><br><span class="line">act.double_click()</span><br><span class="line"># 拖动</span><br><span class="line">act.drag_and_drop()</span><br><span class="line"># 执行鼠标悬停操作</span><br><span class="line">act.move_to_element(above)</span><br><span class="line"># 执行所有 ActionChains 中存储的行为，可以理解成是对整个操作的提交动作</span><br><span class="line">perform()</span><br><span class="line"></span><br><span class="line"># eg:鼠标左击e1,同时拖动到e2</span><br><span class="line">e1 = driver.find_element_by_id(&#x27;source&#x27;)</span><br><span class="line">e2 = driver.find_element_by_id(&#x27;target&#x27;)</span><br><span class="line">ActionChains(driver).drag_and_drop(e1, e2).perform()</span><br><span class="line"># eg: 鼠标左击e,同时拖动固定偏移量</span><br><span class="line">e = driver.find_element_by_id(&#x27;source&#x27;)</span><br><span class="line">ActionChains(driver).drag_and_drop_by_offset(e, -100, -100).perform()</span><br><span class="line"></span><br><span class="line">move_to_element_with_offset  # 不点击，直接移动</span><br><span class="line"></span><br><span class="line"># 内嵌滚动条</span><br><span class="line"># 这个方法可以模拟鼠标滚动到需要显示的元素位置，使用场景：浏览器窗口小，页面过大内容显示不全，元素可以定位但不可见。</span><br><span class="line">target = self.driver.find_element_by_xpath(&quot;//span[@title=&#x27;汇尚客服&#x27;]&quot;);</span><br><span class="line">self.driver.execute_script(&quot;arguments[0].scrollIntoView();&quot;, target)</span><br><span class="line">target.click()</span><br><span class="line"></span><br><span class="line"># 方法二</span><br><span class="line"># 纵向底部</span><br><span class="line">js1 = &#x27;document.getElementById(&quot;crtest&quot;).scrollTop=10000&#x27;</span><br><span class="line">driver.execute_script(js1)</span><br><span class="line"># 纵向顶部</span><br><span class="line">js2 = &#x27;document.getElementById(&quot;crtest&quot;).scrollTop=0&#x27;</span><br><span class="line">driver.execute_script(js2)</span><br><span class="line"></span><br><span class="line"># 横向右侧</span><br><span class="line">js3 = &#x27;document.getElementById(&quot;crtest&quot;).scrollLeft=10000&#x27;</span><br><span class="line">driver.execute_script(js3)</span><br><span class="line"># 横向左侧</span><br><span class="line">js4 = &#x27;document.getElementById(&quot;crtest&quot;).scrollLeft=0&#x27;</span><br><span class="line">driver.execute_script(js4)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="3-键盘事件">3、键盘事件</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">复制# 输入中文，没啥用</span><br><span class="line">send_keys(text.unicode(&#x27;utf-8&#x27;))</span><br><span class="line"># 删除键</span><br><span class="line">send_keys(Keys.BACK_SPACE)</span><br><span class="line"># 回车键</span><br><span class="line">send_keys(Keys.ENTER)</span><br><span class="line"># 组合键：Ctrl + A </span><br><span class="line">send_keys(Keys.CONTROL, &#x27;a&#x27;)</span><br><span class="line"></span><br><span class="line"># eg:清空数据并填入新数据</span><br><span class="line">value = br.find_element_by_id(&#x27;bizOrderId&#x27;)</span><br><span class="line">while True:</span><br><span class="line">    if value.get_attribute(&#x27;value&#x27;) != &#x27;&#x27;:</span><br><span class="line">        value.send_keys(Keys.CONTROL, &#x27;a&#x27;) # 全选</span><br><span class="line">        value.send_keys(Keys.DELETE)    # 删除</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">value.send_keys(Id)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="4-获取断言信息">4、获取断言信息</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">复制# 获取当前页面的标题</span><br><span class="line">title</span><br><span class="line"># 获取当前页面的URL</span><br><span class="line">current_url</span><br><span class="line"># 获取搜索条目的文本信息</span><br><span class="line">text</span><br><span class="line"># 获取标签属性:get_attribute</span><br><span class="line">self.br.find_elements_by_xpath(&#x27;//*[@class=&quot;total&quot;]/p/span/span&#x27;).get_attribute(&#x27;class&#x27;)</span><br><span class="line"># 获取网页全部代码</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="5-嵌套页面问题表单">5、嵌套页面问题(表单)</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">复制# 将当前定位的主体切换为frame/iframe表单的内嵌页面中</span><br><span class="line">br.switch_to.frame(id)</span><br><span class="line"># 跳回最外层的页面</span><br><span class="line">br.switch_to.default_content()</span><br><span class="line"># 回到上一层的ifrmae</span><br><span class="line">driver.switch_to.parent_frame()</span><br><span class="line"></span><br><span class="line"># 存在动态变化的表单，可通过标签的方式进入</span><br><span class="line">iframe = self.driver.find_elements_by_tag_name(&quot;iframe&quot;)[0]</span><br><span class="line">self.driver.switch_to.frame(iframe)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="6-多窗口切换">6、多窗口切换</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">复制# 获得当前窗口句柄</span><br><span class="line">handle = br.current_window_handle</span><br><span class="line"># 返回所有窗口的句柄到当前会话</span><br><span class="line">    br.window_handles</span><br><span class="line"># 用于切换到相应的窗口，与上一节的switch_to.frame()类似，前者用于不同窗口的切换，后者用于不同表单之间的切换。</span><br><span class="line">br.switch_to.window(handle)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="7-警告框处理">7、警告框处理</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">复制# 返回 alert/confirm/prompt 中的文字信息</span><br><span class="line">text</span><br><span class="line"># 接受现有警告框</span><br><span class="line">br.switch_to.alert.accept()</span><br><span class="line"># 解散现有警告框</span><br><span class="line">dismiss()</span><br><span class="line"># 发送文本至警告框。keysToSend：将文本发送至警告框。</span><br><span class="line">send_keys(keysToSend)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="8-下拉框选择操作">8、下拉框选择操作</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">复制# 导入相关类</span><br><span class="line">from selenium.webdriver.support.select import Select</span><br><span class="line"># select标签的value属性的值</span><br><span class="line">select_by_value(“选择值”)</span><br><span class="line"># 下拉框的索引</span><br><span class="line">select_by_index(“索引值”)</span><br><span class="line"># 下拉框的文本值</span><br><span class="line">select_by_visible_text(“文本值”)</span><br><span class="line"></span><br><span class="line"># eg:</span><br><span class="line">sel = br.find_element_by_xpath(&quot;//select[@id=&#x27;nr&#x27;]&quot;)</span><br><span class="line">Select(sel).select_by_value(&#x27;50&#x27;)  # 显示50条</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="9-文件上传">9、文件上传</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">复制# 方法一：</span><br><span class="line"># 其本质是将本地文件地址写入对应的input中：</span><br><span class="line">driver.find_element_by_name(&quot;file&quot;).send_keys(&#x27;D:\upload_file.txt&#x27;)</span><br><span class="line"></span><br><span class="line"># 方法二：</span><br><span class="line"># selenium点击上传后，通过pywin32识别窗口进行后续文件选择操作，下面函数需等待文件选择弹窗出现后执行</span><br><span class="line">def upload_file(file_path):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    :param file_path:上传文件的路径</span><br><span class="line">    :return:</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    dialog = win32gui.FindWindow(&quot;#32770&quot;, &quot;打开&quot;)</span><br><span class="line">    comboxex32 = win32gui.FindWindowEx(dialog, 0, &quot;ComboBoxEx32&quot;, None)</span><br><span class="line">    combox = win32gui.FindWindowEx(comboxex32, 0, &quot;ComboBox&quot;, None)</span><br><span class="line">    edit = win32gui.FindWindowEx(combox, 0, &quot;Edit&quot;, None)</span><br><span class="line">    button = win32gui.FindWindowEx(dialog, 0, &quot;Button&quot;, &quot;打开(&amp;0)&quot;)</span><br><span class="line">    win32gui.SendMessage(edit, win32con.WM_SETTEXT, None, file_path)</span><br><span class="line">    win32gui.SendMessage(dialog, win32con.WM_COMMAND, 1, button)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="10-cookie操作">10、cookie操作</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">复制# 获得所有cookie信息</span><br><span class="line">get_cookies()</span><br><span class="line"># 返回字典的key为“name”的cookie信息</span><br><span class="line">get_cookie(name)</span><br><span class="line"># 添加cookie。“cookie_dict”指字典对象，必须有name 和value 值</span><br><span class="line">add_cookie(cookie_dict)</span><br><span class="line"># 删除cookie信息。“name”是要删除的cookie的名称，“optionsString”是该cookie的选项，目前支持的选项包括“路径”，“域”</span><br><span class="line">delete_cookie(name,optionsString)</span><br><span class="line"># 删除所有cookie信息</span><br><span class="line">delete_all_cookies()</span><br><span class="line"></span><br><span class="line"># eg:</span><br><span class="line">  dict=&#123;&#x27;name&#x27;:&quot;name&quot;,&#x27;value&#x27;:&#x27;Kaina&#x27;&#125;</span><br><span class="line">  br.add_cookie(dict)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="11-窗口截图">11、窗口截图</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">复制#1.截取当前窗口，并指定截图图片的保存位置</span><br><span class="line">driver.get_screenshot_as_file(&quot;D:\\baidu_img.jpg&quot;)</span><br><span class="line"></span><br><span class="line"># 调用cdp命令截图</span><br><span class="line">&quot;&quot;&quot;页面截图&quot;&quot;&quot;</span><br><span class="line">def cut_length_graph(save_path, save_name):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    截图，截长图</span><br><span class="line">    :param save_path: 图片保存路径，绝对路径</span><br><span class="line">    :param save_name: 图片保存名</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    max_height = self.driver.execute_script(&quot;return document.documentElement.scrollHeight&quot;)</span><br><span class="line">    min_height = self.driver.get_window_size()[&#x27;height&#x27;]</span><br><span class="line">    height = min_height</span><br><span class="line">    while True:</span><br><span class="line">        if height &gt; max_height:</span><br><span class="line">            break</span><br><span class="line">        self.driver.execute_script(&quot;window.scrollBy(0,&#123;&#125;)&quot;.format(min_height))</span><br><span class="line">        height += min_height</span><br><span class="line">        time.sleep(1)</span><br><span class="line"></span><br><span class="line">    page_rect = self.driver.execute_cdp_cmd(&#x27;Page.getLayoutMetrics&#x27;, &#123;&#125;)</span><br><span class="line">    screenshot_config = &#123;&#x27;quality&#x27;: 50, &#x27;format&#x27;: &#x27;jpeg&#x27;, &#x27;captureBeyondViewport&#x27;: True,</span><br><span class="line">                         &#x27;clip&#x27;: &#123;</span><br><span class="line">                             &#x27;width&#x27;: page_rect[&#x27;contentSize&#x27;][&#x27;width&#x27;],</span><br><span class="line">                             &#x27;height&#x27;: page_rect[&#x27;contentSize&#x27;][&#x27;height&#x27;],</span><br><span class="line">                             &#x27;x&#x27;: 0,</span><br><span class="line">                             &#x27;y&#x27;: 0,</span><br><span class="line">                             &#x27;scale&#x27;: 1</span><br><span class="line">                         &#125;&#125;</span><br><span class="line">    result = self.driver.execute_cdp_cmd(&#x27;Page.captureScreenshot&#x27;, screenshot_config)</span><br><span class="line"></span><br><span class="line">    save = save_path + &#x27;\\&#x27; + save_name</span><br><span class="line">    with open(save, &#x27;wb&#x27;) as f:</span><br><span class="line">        f.write(base64.b64decode(result[&#x27;data&#x27;]))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="12-调用js代码">12、调用js代码</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">复制# eg: 该js代码表示将窗口滚动条滚动到固定位置</span><br><span class="line">js=&quot;window.scrollTop(100,450);&quot;</span><br><span class="line">br.execute_script(js)</span><br><span class="line">self.driver.execute_script(&quot;var q=document.documentElement.scrollTop=0&quot;)</span><br><span class="line"></span><br><span class="line"># eg:浏览器测边框下滑500</span><br><span class="line">js = &quot;window.scrollBy(0,500)&quot;</span><br><span class="line">driver.execute_script(js)</span><br><span class="line"></span><br><span class="line"># 打开一个新的窗口</span><br><span class="line">js=&#x27;window.open(&quot;https://www.baidu.com&quot;);&#x27; #通过执行js，开启一个新的窗口</span><br><span class="line">driver.execute_script(js)</span><br><span class="line"></span><br><span class="line"># 调用js影藏导航栏</span><br><span class="line">js = &quot;document.getElementsByClassName(&#x27;header&#x27;)[0].style.display = &#x27;none&#x27;;&quot;</span><br><span class="line">driver.execute_script(js)</span><br><span class="line"></span><br><span class="line"># 调用js实现点击命令</span><br><span class="line">js = &#x27;arguments[0].click();&#x27;</span><br><span class="line">element = ele</span><br><span class="line">driver.execute_script(js, element)</span><br><span class="line"></span><br><span class="line"># 滚动至某元素可见</span><br><span class="line">eles = driver.find_elements_by_css_selector(&#x27;#rs table tr th a&#x27;)</span><br><span class="line">ele = eles[0]</span><br><span class="line">driver.execute_script(&quot;arguments[0].scrollIntoView();&quot;,ele)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 避免浏览器识别</span><br><span class="line">driver.execute_script(</span><br><span class="line">        &quot;Object.defineProperty(navigator, &#x27;webdriver&#x27;, &#123;get: () =&gt; undefined&#125;)&quot;</span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="13-关闭窗口包括侧边悬浮窗口">13、关闭窗口(包括侧边悬浮窗口)</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">复制# 关闭单个窗口</span><br><span class="line">br.close()</span><br><span class="line"># 关闭所有窗口</span><br><span class="line">br.quit()</span><br><span class="line"></span><br><span class="line"># 关闭侧边悬浮窗口：窗口的ClassName：aw-window</span><br><span class="line">try:</span><br><span class="line">    self.driver.execute_script(&#x27;document.getElementsByClassName(&quot;aw-window&quot;)[0].style.display = &quot;none&quot;;&#x27;)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="14-cookie处理">14、cookie处理</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">复制# 获得cookie信息</span><br><span class="line">driver.get_cookies（） </span><br><span class="line"># 向cookie添加会话信息</span><br><span class="line">add_cookie(cookie_dict)  </span><br><span class="line"># 删除特定(部分)的cookie</span><br><span class="line">delete_cookie(name)   </span><br><span class="line"># 删除所有cookie</span><br><span class="line">delete_all_cookies()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="15-开发者模式">15、开发者模式</span></h2><h3><span id="1-基本使用">1、基本使用</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">复制# 创建浏览器对象</span><br><span class="line">options = webdriver.ChromeOptions()</span><br><span class="line"># 设置开发者模式</span><br><span class="line">options.add_argument(&quot;--auto-open-devtools-for-tabs&quot;)</span><br><span class="line"># 设置文件路径</span><br><span class="line">options.binary_location = &quot;./chrome/chrome.exe&quot;</span><br><span class="line"># 去掉提示信息：&#x27;浏览器正在被控制中&#x27;</span><br><span class="line">options.add_experimental_option(&#x27;excludeSwitches&#x27;, [&#x27;enable-automation&#x27;])  </span><br><span class="line">driver = webdriver.Chrome(options=options, executable_path=&quot;./chrome/chromedriver&quot;)</span><br><span class="line"># 防止淘宝检测出来，核心代码，通过js将判断值定为：undefined</span><br><span class="line">driver.execute_cdp_cmd(&quot;Page.addScriptToEvaluateOnNewDocument&quot;, &#123;</span><br><span class="line">            &quot;source&quot;: &quot;&quot;&quot;</span><br><span class="line">                Object.defineProperty(navigator, &#x27;webdriver&#x27;, &#123;</span><br><span class="line">                    get: () =&gt; undefined</span><br><span class="line">                &#125;)</span><br><span class="line">            &quot;&quot;&quot;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3><span id="2-示例">2、示例</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">复制##创建浏览器对象</span><br><span class="line">options = webdriver.ChromeOptions()</span><br><span class="line">#设置开发者模式 去掉自动化控制的提示信息</span><br><span class="line">options.add_experimental_option(&#x27;excludeSwitches&#x27;, [&#x27;enable-automation&#x27;])</span><br><span class="line">#不加载图片,加快访问速度</span><br><span class="line"># options.add_experimental_option(&quot;prefs&quot;, &#123;&quot;profile.managed_default_content_settings.images&quot;: 2&#125;)</span><br><span class="line">driver = webdriver.Chrome(options=options)</span><br><span class="line"># 去掉自动控制属性</span><br><span class="line">driver.execute_cdp_cmd(&quot;Page.addScriptToEvaluateOnNewDocument&quot;, &#123;</span><br><span class="line">            &quot;source&quot;: &quot;&quot;&quot;</span><br><span class="line">                Object.defineProperty(navigator, &#x27;webdriver&#x27;, &#123;</span><br><span class="line">                    get: () =&gt; undefined</span><br><span class="line">                &#125;)</span><br><span class="line">            &quot;&quot;&quot;</span><br><span class="line">        &#125;)</span><br><span class="line">driver.get(&quot;https://www.taobao.com/?spm=a2107.1.1000340.1.4a5c11d9BosTHg&quot;)</span><br><span class="line">#隐式等待</span><br><span class="line">driver.implicitly_wait(10)</span><br><span class="line">#将浏览器放大</span><br><span class="line">driver.maximize_window()</span><br><span class="line">#点击登录账号密码</span><br><span class="line">deng = driver.find_element_by_xpath(&quot;//div[@class=&#x27;site-nav-sign&#x27;]/a[@class=&#x27;h&#x27;]&quot;).click()</span><br><span class="line">#点击到帐密登录</span><br><span class="line"># driver.find_element_by_id(&#x27;J_Quick2Static&#x27;).click()</span><br><span class="line">#账号</span><br><span class="line">myusername = driver.find_element_by_id(&#x27;fm-login-id&#x27;)</span><br><span class="line">myusername.send_keys(&#x27;brooksbrothers旗舰店:小布布3&#x27;)</span><br><span class="line">time.sleep(3)</span><br><span class="line"></span><br><span class="line">#密码</span><br><span class="line">mypassword = driver.find_element_by_id(&#x27;fm-login-password&#x27;)</span><br><span class="line">mypassword.send_keys(&quot;TMBB2021&quot;)</span><br><span class="line">time.sleep(1)</span><br><span class="line">#定位滑块</span><br><span class="line"># dragger = driver.find_element_by_id(&#x27;nc_1_n1z&#x27;)  # 滑块定位</span><br><span class="line"># action = ActionChains(driver)</span><br><span class="line"># for index in range(500):</span><br><span class="line">#     try:</span><br><span class="line">#         action.drag_and_drop_by_offset(dragger, 500, 0).perform()  # 平行移动鼠标，此处直接设一个超出范围的值，这样拉到头后会报错从而结束这个动作</span><br><span class="line">#</span><br><span class="line">#     except Exception:</span><br><span class="line">#         break</span><br><span class="line">#     time.sleep(3)  # 等待停顿时间</span><br><span class="line">#点击登录</span><br><span class="line"></span><br><span class="line">button = driver.find_element_by_xpath(&quot;//*[@class=&#x27;fm-btn&#x27;]/button&quot;).click()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3><span id="3-案列2支持配置下载路径同时打开带插件和历史记录的浏览器">3、案列2(支持配置下载路径，同时打开带插件和历史记录的浏览器)</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">复制def create_driver(download_address=&#x27;./&#x27;, add_plug_in=False):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    创建可供操作的浏览器对象</span><br><span class="line">    :param download_address:  下载文件的保存地址</span><br><span class="line">    :param add_plug_in:  是否添加插件</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    def get_parameter(download_address=&#x27;./&#x27;):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        得到配置参数</span><br><span class="line">        :param download_address:</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        # 创建浏览器对象</span><br><span class="line">        options = webdriver.ChromeOptions()</span><br><span class="line">        prefs = &#123;</span><br><span class="line">            &#x27;profile.default_content_settings.popups&#x27;: 0,</span><br><span class="line">            &#x27;download.default_directory&#x27;: download_address,</span><br><span class="line">        &#125;</span><br><span class="line">        # 设置开发者模式</span><br><span class="line">        options.binary_location = &#x27;.&#x27; + &quot;/brower/chrome/chrome.exe&quot;</span><br><span class="line">        options.add_experimental_option(&#x27;prefs&#x27;, prefs)</span><br><span class="line">        options.add_experimental_option(&#x27;excludeSwitches&#x27;, [&#x27;enable-automation&#x27;])</span><br><span class="line"></span><br><span class="line">        options.add_argument(&quot;--disable-blink-features=AutomationControlled&quot;)  # 避免被淘宝发现</span><br><span class="line">        options.add_argument(</span><br><span class="line">            &quot;--user-data-dir=&quot; + r&quot;C:\\Users\\LM0060\\AppData\\Local\\Temp\\scoped_dir11960_2125129405\\&quot;)  # 打开带插件的浏览器</span><br><span class="line"></span><br><span class="line">        driver = webdriver.Chrome(options=options, executable_path=&#x27;.&#x27; + &quot;/brower/chrome/chromedriver&quot;)</span><br><span class="line">        driver.execute_cdp_cmd(&quot;Page.addScriptToEvaluateOnNewDocument&quot;, &#123;</span><br><span class="line">            &quot;source&quot;: &quot;&quot;&quot;</span><br><span class="line">                        Object.defineProperty(navigator, &#x27;webdriver&#x27;, &#123;</span><br><span class="line">                            get: () =&gt; undefined</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &quot;&quot;&quot;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        driver.maximize_window()  # 最大化窗口</span><br><span class="line">        driver.get(&quot;chrome://version/&quot;)</span><br><span class="line">        time.sleep(2)</span><br><span class="line"></span><br><span class="line">        parameter = driver.find_element_by_xpath(&quot;//*[@id=&#x27;profile_path&#x27;]&quot;).text.replace(&#x27;Default&#x27;, &#x27;&#x27;)</span><br><span class="line">        messagebox.showinfo(&#x27;提示&#x27;, &quot;请手动导入所需插件后点击确定&quot;)</span><br><span class="line">        driver.quit()</span><br><span class="line">        return parameter</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        parameter = getData()[&#x27;parameter&#x27;]</span><br><span class="line">        if add_plug_in:  # 如果需要添加插件，还是需要用户手动添加，随后重启</span><br><span class="line">            parameter = get_parameter()  # 自动化获取</span><br><span class="line">            data = getData()</span><br><span class="line">            data[&#x27;parameter&#x27;] = parameter</span><br><span class="line">            setData(data)</span><br><span class="line"></span><br><span class="line">    except BaseException as err:</span><br><span class="line">        parameter = get_parameter()  # 自动化获取</span><br><span class="line">        data = getData()</span><br><span class="line">        data[&#x27;parameter&#x27;] = parameter</span><br><span class="line">        setData(data)</span><br><span class="line"></span><br><span class="line">    # 创建浏览器对象</span><br><span class="line">    options = webdriver.ChromeOptions()</span><br><span class="line">    prefs = &#123;</span><br><span class="line">        &#x27;profile.default_content_settings.popups&#x27;: 0,</span><br><span class="line">        &#x27;download.default_directory&#x27;: download_address,</span><br><span class="line">    &#125;</span><br><span class="line">    # 设置开发者模式</span><br><span class="line">    options.binary_location = &#x27;.&#x27; + &quot;/brower/chrome/chrome.exe&quot;</span><br><span class="line">    options.add_experimental_option(&#x27;prefs&#x27;, prefs)</span><br><span class="line">    options.add_experimental_option(&#x27;excludeSwitches&#x27;, [&#x27;enable-automation&#x27;])</span><br><span class="line"></span><br><span class="line">    options.add_argument(&quot;--disable-blink-features=AutomationControlled&quot;)  # 避免被淘宝发现</span><br><span class="line">    options.add_argument(&quot;--user-data-dir=&quot; + parameter)  # 打开带插件的浏览器</span><br><span class="line"></span><br><span class="line">    driver = webdriver.Chrome(options=options, executable_path=&#x27;.&#x27; + &quot;/brower/chrome/chromedriver&quot;)</span><br><span class="line">    driver.execute_cdp_cmd(&quot;Page.addScriptToEvaluateOnNewDocument&quot;, &#123;</span><br><span class="line">        &quot;source&quot;: &quot;&quot;&quot;</span><br><span class="line">                    Object.defineProperty(navigator, &#x27;webdriver&#x27;, &#123;</span><br><span class="line">                        get: () =&gt; undefined</span><br><span class="line">                    &#125;)</span><br><span class="line">                &quot;&quot;&quot;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    driver.maximize_window()  # 最大化窗口</span><br><span class="line">    return driver</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3><span id="4-案列3">4、案列3</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">复制from selenium.webdriver.chrome.options import Options</span><br><span class="line"></span><br><span class="line">def create_driver():</span><br><span class="line">    # 新打开一个浏览器</span><br><span class="line">    os.popen(</span><br><span class="line">        &#x27;.\\brower\\chrome\\chrome.exe --remote-debugging-port=9222 --user-data-dir=&quot;.\\selenum\\AutomationProfile&quot;&#x27;)</span><br><span class="line">    time.sleep(2)</span><br><span class="line">    options = Options()</span><br><span class="line">    options.add_experimental_option(&quot;debuggerAddress&quot;, &quot;127.0.0.1:9222&quot;)</span><br><span class="line">    driverpath = &#x27;.\\brower\\chrome\\chromedriver.exe&#x27;</span><br><span class="line">    dr = webdriver.Chrome(driverpath, options=options)</span><br><span class="line">    try:</span><br><span class="line">        dr.execute_cdp_cmd(&quot;Page.addScriptToEvaluateOnNewDocument&quot;, &#123;</span><br><span class="line">            &quot;source&quot;: &quot;&quot;&quot;</span><br><span class="line">            Object.defineProperty(navigator, &#x27;webdriver&#x27;, &#123;</span><br><span class="line">              get: () =&gt; undefined</span><br><span class="line">            &#125;)</span><br><span class="line">          &quot;&quot;&quot;</span><br><span class="line">        &#125;)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    dr.maximize_window()</span><br><span class="line">    dr.set_page_load_timeout(15)</span><br><span class="line">    dr.set_script_timeout(15) </span><br><span class="line">    return dr</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="16-网页自动化下载">16、网页自动化下载</span></h2><h3><span id="1-点击下载事件">1、点击下载事件</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">复制# Google平台</span><br><span class="line">from selenium import webdriver</span><br><span class="line">from time import sleep</span><br><span class="line"> </span><br><span class="line">chrome_options = webdriver.ChromeOptions()</span><br><span class="line">prefs = &#123;</span><br><span class="line">    &#x27;profile.default_content_settings.popups&#x27;: 0, </span><br><span class="line">    &#x27;download.default_directory&#x27;: &#x27;d:\\&#x27;,</span><br><span class="line">    &quot;download.prompt_for_download&quot;: False</span><br><span class="line">&#125;</span><br><span class="line"># 将我们的配置写入实例中，配置中各项参数说明在最后</span><br><span class="line">chrome_options.add_experimental_option(&#x27;prefs&#x27;, prefs) #添加实验性质的设置参数</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome(options=chrome_options)</span><br><span class="line">driver.get(&#x27;http://haozip.2345.cc/&#x27;)</span><br><span class="line">driver.find_element_by_class_name(&#x27;btn_dl&#x27;).click()</span><br><span class="line">sleep(3)</span><br><span class="line"></span><br><span class="line"># Chrome下载默认不会弹出提示框，这里只要修改他的下载位置就可以了， 设置为  0 禁止弹出窗口</span><br><span class="line">profile.default_content_settings.popups</span><br><span class="line"># 设置下载路径</span><br><span class="line">download.default_directory</span><br><span class="line"># 设置是否允许下载多个文件</span><br><span class="line">profile.default_content_setting_values.automatic_downloads</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">复制# 火狐浏览器</span><br><span class="line">from selenium import webdriver</span><br><span class="line"># 实例化一个火狐配置文件</span><br><span class="line">fp = webdriver.FirefoxProfile()</span><br><span class="line"></span><br><span class="line"># 设置各项参数，参数可以通过在浏览器地址栏中输入about:config查看。</span><br><span class="line"></span><br><span class="line"># 设置成0代表下载到浏览器默认下载路径；设置成2则可以保存到指定目录</span><br><span class="line">fp.set_preference(&quot;browser.download.folderList&quot;, 2)</span><br><span class="line"></span><br><span class="line"># 是否显示开始,(个人实验，不管设成True还是False，都不显示开始，直接下载)</span><br><span class="line">fp.set_preference(&quot;browser.download.manager.showWhenStarting&quot;, False)</span><br><span class="line"># 下载到指定目录</span><br><span class="line">fp.set_preference(&quot;browser.download.dir&quot;, &quot;c:\\Temp&quot;)</span><br><span class="line"># 不询问下载路径；后面的参数为要下载页面的Content-type的值</span><br><span class="line">fp.set_preference(&quot;browser.helperApps.neverAsk.saveToDisk&quot;, &quot;application/octet-stream&quot;)</span><br><span class="line"></span><br><span class="line"># 启动一个火狐浏览器进程，以刚才的浏览器参数</span><br><span class="line">driver = webdriver.Firefox(firefox_profile=fp)</span><br><span class="line"># 打开下载页面</span><br><span class="line">driver.get(&quot;https://pypi.python.org/pypi/selenium&quot;)</span><br><span class="line"></span><br><span class="line"># 点击某个按钮</span><br><span class="line">driver.find_element_by_xpath(&quot;//*[@id=&#x27;content&#x27;]/div[3]/table/tbody/tr[2]/td[1]/span&quot;).click()</span><br><span class="line"></span><br><span class="line"># 设定下载路径为项目路径</span><br><span class="line">create_driver(os.getcwd() + local_path[1:].replace(&#x27;/&#x27;, &#x27;\\&#x27;) + &#x27;\\upload_data\\&#x27; + shop_name)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3><span id="2-通过链接下载事件">2、通过链接下载事件</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">复制from urllib.request import urlretrieve</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line"># 下载图片</span><br><span class="line">def urllib_download(url, path, name):</span><br><span class="line">    urlretrieve(url, path + &#x27;/&#x27; + name)</span><br><span class="line"># 下载图片</span><br><span class="line">def request_download(url, path, name):</span><br><span class="line">    r = requests.get(url)</span><br><span class="line">    with open(path + &#x27;/&#x27; + name, &#x27;wb&#x27;) as f:</span><br><span class="line">        f.write(r.content)</span><br><span class="line"># 下载图片</span><br><span class="line">def chunk_download(url, path, name):</span><br><span class="line">    r = requests.get(url, stream=True)</span><br><span class="line">    with open(path + &#x27;/&#x27; + name, &#x27;wb&#x27;) as f:</span><br><span class="line">        for chunk in r.iter_content(chunk_size=32):</span><br><span class="line">            f.write(chunk)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3><span id="3-网页链接图片下载">3、网页链接图片下载</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">复制# 下载链接图片</span><br><span class="line">import requests</span><br><span class="line">r = requests.get(img_url)</span><br><span class="line">with open(local_path + &#x27;/img/photo.png&#x27;, &#x27;wb&#x27;) as f:</span><br><span class="line">    f.write(r.content)</span><br><span class="line">    </span><br><span class="line"># 下载文件，包含但不限于图片</span><br><span class="line">from urllib.request import urlretrieve</span><br><span class="line">urlretrieve(url, path + &#x27;/&#x27; + name)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="17-页面内嵌滚动条">17、页面内嵌滚动条</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">复制# 定位.hYME_lrqafV div（表示class=hYME_lrqafV元素 下的div）</span><br><span class="line">self.driver.execute_script(&quot;document.querySelector(&#x27;.hYME_lrqafV div&#x27;).scrollTo(0,-100)&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="18-让浏览器只剩一个活动窗口">18、让浏览器只剩一个活动窗口</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">复制for ind in self.driver.window_handles:</span><br><span class="line">    try:</span><br><span class="line">        self.driver.switch_to.window(self.driver.window_handles[1])</span><br><span class="line">        self.driver.close()</span><br><span class="line">        self.driver.switch_to.window(self.driver.window_handles[0])</span><br><span class="line">        time.sleep(1)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1><span id="三-等待操作">三、等待操作</span></h1><p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/237481.htm">博客介绍</a></p>
<h2><span id="1-绝对等待">1、绝对等待</span></h2><blockquote>
<p><strong>等待规定时间后，直接执行后面的代码</strong></p>
<p>等待5秒：time.sleep(5)</p>
</blockquote>
<h2><span id="2-隐形等待全局设置">2、隐形等待(全局设置)</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">复制# 隐性延时，最长是30秒，如果30秒内，资源全部加载完成，那么执行后续的代码，</span><br><span class="line"># 30秒内没有加载完成，也会继续执行后续代码</span><br><span class="line">driver.implicitly_wait(30)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2><span id="3-显性等待">3、显性等待</span></h2><blockquote>
<p><strong>下面列出的各种判断，如成立则继续向下执行，如不存在则会在超时后报错</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">复制# 显性等待，等待时长20秒，间隔0.5秒去查询一次，目标元素是否加载完成</span><br><span class="line"># 20秒内加载完成后，执行后续的代码，最长等待20秒，没有加载也会继续执行</span><br><span class="line">from selenium.webdriver.support.wait import WebDriverWait</span><br><span class="line">from selenium.webdriver.support import expected_conditions as EC</span><br><span class="line">from selenium.webdriver.common.by import By</span><br><span class="line">driver.get(&#x27;https://huilansame.github.io&#x27;)</span><br><span class="line">locator = (By.XPATH, &quot;//h3[contains(text(), &#x27;商品腰带&#x27;)]&quot;)</span><br><span class="line"></span><br><span class="line"># 20 秒是最长等待时间，  0.5 秒是间隔轮询时间（等待元素出现）</span><br><span class="line">WebDriverWait(driver, 20, 0.5).until(EC.visibility_of_element_located(locator))</span><br><span class="line"># 20 秒是最长等待时间，  0.5 秒是间隔轮询时间（等待元素消失）</span><br><span class="line">WebDriverWait(driver, 20, 0.5).until_not(EC.presence_of_element_located(locator))</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">presence_of_element_located： 当我们不关心元素是否可见，只关心元素是否存在在页面中。</span><br><span class="line">visibility_of_element_located： 当我们需要找到元素，并且该元素也可见。</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"># 判断某个element是否被加载到dom树</span><br><span class="line">target = EC.presence_of_element_located((By.ID,&#x27;user&#x27;))</span><br><span class="line"># 判断某个element中是否可见并且可点击</span><br><span class="line">target = EC.element_to_be_clickable((By.ID,&#x27;user&#x27;))</span><br><span class="line"># 判断某个element是否被选中</span><br><span class="line">element = driver.find_element_by_class_name(&#x27;selector&#x27;)</span><br><span class="line">EC.element_to_be_selected(element)</span><br><span class="line"></span><br><span class="line"># 等待出现并点击</span><br><span class="line">wait = WebDriverWait(driver, 20, 0.5)</span><br><span class="line">wait.until(lambda diver:diver.find_element_by_xpath(&quot;//h3[contains(text(), &#x27;商品腰带&#x27;)]&quot;)).click()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1><span id="四-关于打包">四、关于打包</span></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">复制1、下载Pyinstaller : pip install Pyinstaller</span><br><span class="line">2、进入项目目录（终端进入）</span><br><span class="line">3、- Pyinstaller -F setup.py  # 普通打包</span><br><span class="line">   - Pyinstaller -Fw setup.py  # 不带控制台的打包</span><br><span class="line">   - Pyinstaller -i xx.ico setup.py  #指定图标的打包</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">复制# 打包后如果运行出现dos界面则：</span><br><span class="line">解决方案就是修改selenium包中的service.py（selenium-&gt;webdriver-&gt;common-&gt;service.py）源码75行</span><br><span class="line">cmd = [self.path]</span><br><span class="line">cmd.extend(self.command_line_args())</span><br><span class="line">self.process = subprocess.Popen(cmd, env=self.env,</span><br><span class="line">                                close_fds=platform.system() != &#x27;Windows&#x27;,</span><br><span class="line">                                stdout=self.log_file,</span><br><span class="line">                                stderr=self.log_file,</span><br><span class="line">                                stdin=PIPE, creationflags=134217728) # 此处改动</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1><span id="五-秋梦哥笔记">五、秋梦哥笔记</span></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">复制from pywinauto import Desktop</span><br><span class="line"></span><br><span class="line">#点击网页元素</span><br><span class="line">def ele_click(dr,ele):</span><br><span class="line">    try:</span><br><span class="line">        ele.click()</span><br><span class="line">    except:</span><br><span class="line">        js = &quot;arguments[0].click();&quot;</span><br><span class="line">        element = ele</span><br><span class="line">        dr.execute_script(js, element)</span><br><span class="line">#等待元素出现</span><br><span class="line">def wait_ele_display(main_ele,mode,location):#main_ele:定位的起始主要元素，mode:定位的方式，location:定位的关键标志</span><br><span class="line">    while True:</span><br><span class="line">        expression = &#x27;main_ele.find_element_by_&#x27;+str(mode)+&#x27;(\&quot;\&quot;\&quot;&#x27;+str(location)+&#x27;\&quot;\&quot;\&quot;)&#x27;</span><br><span class="line">        print(expression,type(expression))</span><br><span class="line">        try:</span><br><span class="line">            ele = eval(expression)</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;获取不到元素&#x27;)</span><br><span class="line">        else:</span><br><span class="line">            if ele.is_displayed():</span><br><span class="line">                break</span><br><span class="line">            else:</span><br><span class="line">                print(&#x27;获取到元素但是元素未显示在页面&#x27;)</span><br><span class="line">#等待元素消失或者隐藏</span><br><span class="line">def wait_ele_no_display(main_ele,mode,location):</span><br><span class="line">    while True:</span><br><span class="line">        expression = &#x27;main_ele.find_element_by_&#x27;+str(mode)+&#x27;(\&quot;\&quot;\&quot;&#x27;+str(location)+&#x27;\&quot;\&quot;\&quot;)&#x27;</span><br><span class="line">        print(expression,type(expression))</span><br><span class="line">        try:</span><br><span class="line">            ele = eval(expression)</span><br><span class="line">        except:</span><br><span class="line">            break</span><br><span class="line">        else:</span><br><span class="line">            print(&#x27;元素还未消失&#x27;)</span><br><span class="line">            if ele.is_displayed():</span><br><span class="line">                print(&#x27;元素还未隐藏&#x27;)</span><br><span class="line">            else:</span><br><span class="line">                break</span><br><span class="line">#上传文件</span><br><span class="line">def upload_file(file_path):</span><br><span class="line">    app = Desktop()  # 创建操作桌面的对象</span><br><span class="line"></span><br><span class="line">    dlg = app[&quot;打开&quot;]  # 获取弹窗的窗口标题</span><br><span class="line"></span><br><span class="line">    #dlg.print_ctrl_ids()  # 打印窗口的所有控件信息</span><br><span class="line"></span><br><span class="line">    #dlg[&quot;地址: xiaominToolbar&quot;].click()  # 获取文件路径填写输入框并点击</span><br><span class="line"></span><br><span class="line">    #send_keys(file_path)  # 在文件路径填写输入框输入文件存在的路径</span><br><span class="line"></span><br><span class="line">    #send_keys(&quot;&#123;VK_RETURN&#125;&quot;)  # 输入文件路径后按回车键</span><br><span class="line"></span><br><span class="line">    dlg[&quot;文件名(&amp;N):Edit&quot;].type_keys(file_path)  # 获取文件名输入框并填写文件名</span><br><span class="line"></span><br><span class="line">    dlg[&quot;打开(&amp;O)&quot;].click()  # 获取“打开”控件并点击</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1><span id="六-页面截图截长图">六、页面截图，截长图</span></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">复制def ScreenshotLength(dr, path, filename):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    截图函数，截取浏览器长图</span><br><span class="line">    :param dr: selenium对象</span><br><span class="line">    :param path: 存储路径</span><br><span class="line">    :param filename: 文件名</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # dr = open_brower(share_root_path)</span><br><span class="line">    # 获得浏览器截下来图片的宽高</span><br><span class="line">    if os.path.exists(path + &#x27;\\temporary&#x27;):</span><br><span class="line">        pass</span><br><span class="line">    else:</span><br><span class="line">        os.mkdir(path + &#x27;\\temporary&#x27;)</span><br><span class="line">    mainpicpath = path + &#x27;\\temporary\\mainpic.png&#x27;</span><br><span class="line">    dr.save_screenshot(mainpicpath)</span><br><span class="line">    img = Image.open(mainpicpath)</span><br><span class="line">    width, height = img.size</span><br><span class="line"></span><br><span class="line">    # 获得当前页面的宽高</span><br><span class="line">    nowpagewidth = dr.execute_script(&quot;return document.documentElement.scrollWidth&quot;)</span><br><span class="line">    nowpageheight = dr.execute_script(&quot;return document.documentElement.scrollHeight&quot;)</span><br><span class="line">    print(nowpagewidth, nowpageheight)</span><br><span class="line">    # 截取全屏</span><br><span class="line">    # 先获得当前页面高度够滚动几次浏览器屏幕count，剩下多少像素remainpx</span><br><span class="line">    count = nowpageheight // height</span><br><span class="line">    remainpx = nowpageheight % height</span><br><span class="line">    # 设置截取下来的图片路径列表</span><br><span class="line">    img_path = []</span><br><span class="line">    # 截取图片</span><br><span class="line">    for i in range(0, count):</span><br><span class="line">        js = &quot;scrollTo(0,%s)&quot; % (i * height)  # 用于移动滑轮，每次移动height的px，初始值是元素的初始高度</span><br><span class="line">        dr.execute_script(js)  # 执行js</span><br><span class="line">        time.sleep(0.5)</span><br><span class="line">        fp = path + &quot;\\temporary\\%s.png&quot; % str(i)  # 图片地址</span><br><span class="line">        if i &gt; 0:</span><br><span class="line">            # 先隐藏页面所有的浮动元素</span><br><span class="line">            try:</span><br><span class="line">                dr.execute_script(&#x27;document.getElementById(&quot;imk2FixedBottom&quot;).style.display=&quot;none&quot;;&#x27;</span><br><span class="line">                                  &#x27;document.getElementsByClassName(&quot;site_fix_bottom&quot;)[0].style.display=&quot;none&quot;;&#x27;</span><br><span class="line">                                  &#x27;document.getElementsByClassName(&quot;module_header_container&quot;)[0].style.display=&quot;none&quot;;&#x27;</span><br><span class="line">                                  &#x27;document.getElementsByClassName(&quot;site_header_background_image_inside&quot;)[0].style.display=&quot;none&quot;;&#x27;)</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line"></span><br><span class="line">        dr.save_screenshot(fp)  # 屏幕截图</span><br><span class="line">        img_path.append(fp)</span><br><span class="line">    if remainpx &gt; 0:</span><br><span class="line">        dr.execute_script(&quot;scrollTo(0,%s)&quot; % nowpageheight)</span><br><span class="line">        time.sleep(0.5)</span><br><span class="line">        fp = path + &quot;\\temporary\\%s.png&quot; % str(count + 1)  # 图片地址</span><br><span class="line">        dr.save_screenshot(fp)  # 屏幕截图</span><br><span class="line">        imglast = Image.open(fp=fp)</span><br><span class="line">        imglast = imglast.crop((0, height - remainpx, width, height))</span><br><span class="line">        imglast.save(fp)</span><br><span class="line">        img_path.append(fp)</span><br><span class="line">    # 把所有图片粘到一起</span><br><span class="line">    new_img = Image.new(&quot;RGB&quot;, (nowpagewidth, nowpageheight))  # 创建一个新图片,大小为元素的大小</span><br><span class="line">    k = 0</span><br><span class="line">    new_imgpath = path + &#x27;\\&#x27; + filename + &#x27;.png&#x27;</span><br><span class="line">    for i in img_path:</span><br><span class="line">        tem_img = Image.open(i)</span><br><span class="line">        new_img.paste(tem_img, (0, height * k))  # 把图片贴上去,间隔一个截图的距离</span><br><span class="line">        k += 1</span><br><span class="line">    else:</span><br><span class="line"></span><br><span class="line">        try:</span><br><span class="line">            os.makedirs(path)</span><br><span class="line">        except:</span><br><span class="line">            print(path, &#x27;已创建&#x27;)</span><br><span class="line"></span><br><span class="line">        new_img.save(new_imgpath)  # 保存</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1><span id="七-相关平台的登录与登出">七、相关平台的登录与登出</span></h1><h3><span id="1-登录天猫">1、登录天猫</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">复制def login_tm(self, name, pwd):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    登录天猫平台</span><br><span class="line">    :param name: 账号</span><br><span class="line">    :param pwd: 密码</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    # 处理滑块验证</span><br><span class="line">    def check_yzm(check_yzm_span):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        处理滑动验证码，没有测试</span><br><span class="line">        :param check_yzm_span:</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        # 实例化一个动作链关联游览器</span><br><span class="line">        action = ActionChains(self.driver)</span><br><span class="line">        # 使用鼠标动作链进行点击并悬浮</span><br><span class="line">        action.click_and_hold(check_yzm_span)</span><br><span class="line">        # 滑动验证码</span><br><span class="line">        action.move_by_offset(xoffset=350, yoffset=0).perform()</span><br><span class="line">        time.sleep(1)</span><br><span class="line">        # 再次点击登录按钮</span><br><span class="line">        self.find(&#x27;//*[@id=&quot;login-form&quot;]/div[4]/button&#x27;).click()</span><br><span class="line"></span><br><span class="line">    def huakuai():  # 如果有滑块，则进入内层嵌套表单，并进行滑块处理</span><br><span class="line">        while True:</span><br><span class="line">            try:</span><br><span class="line">                self.driver.switch_to.frame(&#x27;baxia-dialog-content&#x27;)</span><br><span class="line">                check_yzm_span = self.find(&#x27;//*[@id=&quot;nc_1_n1z&quot;]&#x27;)  # 延时定位滑动验证码标签，避免点击登录按钮之后，出现滑动验证码，不需要验证的情况</span><br><span class="line">                check_yzm(check_yzm_span)  # 处理滑动验证码</span><br><span class="line">            except:</span><br><span class="line">                break</span><br><span class="line">        time.sleep(1)</span><br><span class="line"></span><br><span class="line">    self.driver.get(&quot;https://loginmyseller.taobao.com/&quot;)</span><br><span class="line">    self.driver.maximize_window()</span><br><span class="line">    self.driver.switch_to.frame(&#x27;alibaba-login-box&#x27;)  # 进入iframe表单</span><br><span class="line"></span><br><span class="line">    self.sure_click(&quot;//input[@id=&#x27;fm-login-id&#x27;]&quot;)</span><br><span class="line">    time.sleep(0.2)</span><br><span class="line">    self.sure_click(&quot;//input[@id=&#x27;fm-login-id&#x27;]&quot;)</span><br><span class="line">    time.sleep(2)</span><br><span class="line">    # 这里可能存在账号被记录，所以需要清空</span><br><span class="line">    while self.find(&quot;//input[@id=&#x27;fm-login-id&#x27;]&quot;).get_attribute(&#x27;value&#x27;) != &#x27;&#x27;:</span><br><span class="line">        self.find(&quot;//input[@id=&#x27;fm-login-id&#x27;]&quot;).clear()</span><br><span class="line">    while self.find(&quot;//input[@id=&#x27;fm-login-password&#x27;]&quot;).get_attribute(&#x27;value&#x27;) != &#x27;&#x27;:</span><br><span class="line">        self.find(&quot;//input[@id=&#x27;fm-login-password&#x27;]&quot;).clear()</span><br><span class="line"></span><br><span class="line">    self.find(&quot;//input[@id=&#x27;fm-login-id&#x27;]&quot;).send_keys(name)  # 输入账号</span><br><span class="line">    self.find(&quot;//input[@id=&#x27;fm-login-password&#x27;]&quot;).send_keys(pwd)  # 输入密码</span><br><span class="line">    self.sure_click(&quot;//button[@type=&#x27;submit&#x27;]&quot;)  # 点击登录</span><br><span class="line"></span><br><span class="line">    time.sleep(1)</span><br><span class="line"></span><br><span class="line">    # 如果有滑块，则进入内层嵌套表单，并进行滑块处理</span><br><span class="line">    huakuai()</span><br><span class="line">    # 判断是否需要点击验证，再次滑动滑块</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            self.driver.find_element_by_xpath(&quot;//div[@id=&#x27;`nc_1_refresh1`&#x27;]&quot;).click()</span><br><span class="line">            self.driver.switch_to.default_content()</span><br><span class="line">            huakuai()</span><br><span class="line">        except:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    # 如果存在短信验证，则提醒用户手动验证</span><br><span class="line">    try:  # 1、直接跳转至短信验证页面</span><br><span class="line">        # 跳出滑块表单，点击登录</span><br><span class="line">        self.driver.switch_to.default_content()</span><br><span class="line">        self.driver.switch_to.frame(&#x27;alibaba-login-box&#x27;)</span><br><span class="line">        try:</span><br><span class="line">            time.sleep(5)</span><br><span class="line">            self.find(&quot;//label[contains(text(), &#x27;验证码&#x27;)]&quot;)</span><br><span class="line">            # tips(&#x27;需要验证码，请手动完成后点击确定&#x27;)</span><br><span class="line">        except:</span><br><span class="line">            try:</span><br><span class="line">                self.find(&quot;//button[@type=&#x27;submit&#x27;]&quot;).click()  # 点击登录</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    if self.driver.title == &#x27;验证码拦截&#x27;:  # 跳转至另一个短信验证页面</span><br><span class="line">        # tips(&#x27;需要验证码，请手动完成后点击确定&#x27;)</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    while True:</span><br><span class="line">        if self.driver.title == &#x27;天猫千牛工作台&#x27; or self.driver.title == &#x27;天猫商家中心&#x27;:</span><br><span class="line">            time.sleep(5)</span><br><span class="line">            self.obvious_wait(&quot;//i[contains(@class, &#x27;on-close&#x27;)]&quot;)</span><br><span class="line">            # try:</span><br><span class="line">            #     self.driver.find_element_by_xpath(</span><br><span class="line">            #         &quot;//i[contains(@class, &#x27;on-close&#x27;)]&quot;).click()  # 存在提示信息，点击关闭</span><br><span class="line">            # except:</span><br><span class="line">            #     break</span><br><span class="line">            break</span><br><span class="line">    # self.obvious_wait(&quot;//i[contains(@class, &#x27;on-close&#x27;)]&quot;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3><span id="2-退出天猫">2、退出天猫</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">复制def logout_tm(self):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    注销天猫账号</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # 使浏览器只剩一个窗口</span><br><span class="line">    for ind in self.driver.window_handles:</span><br><span class="line">        try:</span><br><span class="line">            self.driver.switch_to.window(self.driver.window_handles[1])</span><br><span class="line">            self.driver.close()</span><br><span class="line">            self.driver.switch_to.window(self.driver.window_handles[0])</span><br><span class="line">            time.sleep(1)</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">    self.driver.get(&#x27;https://myseller.taobao.com/home.htm#/index&#x27;)</span><br><span class="line">    self.sure_click(&quot;//a[@id=&#x27;J_Logout&#x27;]&quot;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3><span id="3-登录京东">3、登录京东</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line">复制def login_jd(self, name, pwd):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    登录京东平台</span><br><span class="line">    :param pwd: 账号</span><br><span class="line">    :param name: 密码</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    def Drag_the(block, juli, aLocal, H, W):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        用于移动滑块</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        x = block.location.get(&#x27;x&#x27;)</span><br><span class="line">        y = block.location.get(&#x27;y&#x27;)</span><br><span class="line">        x1 = aLocal.get(&#x27;x&#x27;)</span><br><span class="line">        y1 = aLocal.get(&#x27;y&#x27;)</span><br><span class="line">        pyautogui.moveTo(x + x1 + W, y + y1 + H, duration=0.1)</span><br><span class="line">        pyautogui.mouseDown()</span><br><span class="line">        # 分为多段滑动</span><br><span class="line">        count = 0</span><br><span class="line">        i = 1</span><br><span class="line">        o = 0</span><br><span class="line">        while count &lt; juli * 0.8:</span><br><span class="line">            q = random.randint(10, 20)</span><br><span class="line">            if q &gt; o:</span><br><span class="line">                # print(q)</span><br><span class="line">                count += q</span><br><span class="line">                pyautogui.moveTo(x + x1 + W + count, y + y1 + H, duration=random.randint(1, 9) / (i * 100))</span><br><span class="line">                o = q</span><br><span class="line">                i += 1</span><br><span class="line">            elif q == o:</span><br><span class="line">                # print(q)</span><br><span class="line">                count += q</span><br><span class="line">                pyautogui.moveTo(x + x1 + W + count, y + y1 + H, duration=random.randint(1, 9) / (i * 100))</span><br><span class="line">                o = 0</span><br><span class="line">                i += 1</span><br><span class="line">        o = 10</span><br><span class="line">        while count &gt;= juli * 0.8 and count &lt; juli:</span><br><span class="line">            q = random.randint(1, 8)</span><br><span class="line">            if q &lt;= o:</span><br><span class="line">                # print(str(q)+&quot;..&quot;)</span><br><span class="line">                count += q</span><br><span class="line">                pyautogui.moveTo(x + x1 + W + count, y + y1 + H, duration=random.randint(1, 9) / (i * 100))</span><br><span class="line">        pyautogui.moveTo(x + x1 + W + juli - 2, y + y1 + H, duration=0.2)</span><br><span class="line">        time.sleep(0.8)</span><br><span class="line">        pyautogui.moveTo(x + x1 + W + juli - 1, y + y1 + H, duration=0.2)</span><br><span class="line">        pyautogui.mouseUp()</span><br><span class="line"></span><br><span class="line">    self.driver.get(&#x27;https://shop.jd.com/&#x27;)</span><br><span class="line">    time.sleep(2)</span><br><span class="line">    self.driver.maximize_window()</span><br><span class="line">    try:  # 如果当前已有账号登录，且账号是对的</span><br><span class="line">        if self.find(&quot;//span[@class=&#x27;shop-pageframe-header__pin&#x27;]&quot;).text == name:</span><br><span class="line">            return True</span><br><span class="line">        else:  # 如果当前已有账号登录，且非指定账号，则退出</span><br><span class="line">            self.logout_jd()</span><br><span class="line">    except BaseException:</span><br><span class="line">        pass</span><br><span class="line">    # 获取屏幕大小</span><br><span class="line">    winW, winH = pyautogui.size()</span><br><span class="line">    self.sure_click(&quot;//div[contains(text(),  &#x27;账户登录&#x27;)]&quot;)</span><br><span class="line">    a = self.driver.find_element_by_id(&#x27;loginFrame&#x27;)</span><br><span class="line">    # 获得iframe的网页位置</span><br><span class="line">    iframeLocal = a.location</span><br><span class="line">    h = self.find(&#x27;//body&#x27;)</span><br><span class="line">    # 获得网页body的大小</span><br><span class="line">    bodySize = h.size</span><br><span class="line">    # 获得网页与屏幕顶端的高度差</span><br><span class="line">    WHH = winH - bodySize.get(&#x27;height&#x27;)</span><br><span class="line">    self.driver.switch_to.frame(a)</span><br><span class="line">    self.driver.find_element_by_id(&#x27;loginname&#x27;).clear()</span><br><span class="line">    self.driver.find_element_by_id(&#x27;loginname&#x27;).send_keys(name)</span><br><span class="line">    self.driver.find_element_by_id(&#x27;nloginpwd&#x27;).clear()</span><br><span class="line">    self.driver.find_element_by_id(&#x27;nloginpwd&#x27;).send_keys(pwd)</span><br><span class="line">    try:</span><br><span class="line">        time.sleep(4)</span><br><span class="line">        self.driver.find_element_by_id(&#x27;paipaiLoginSubmit&#x27;).click()</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    time.sleep(1)</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            bl = self.driver.find_element_by_class_name(&#x27;JDJRV-smallimg &gt; img&#x27;)</span><br><span class="line">        except NoSuchElementException:</span><br><span class="line">            bl = False</span><br><span class="line">        if bl != False:</span><br><span class="line">            # 用于找到登录图片的大图</span><br><span class="line">            bigimg = self.driver.find_element_by_class_name(&#x27;JDJRV-bigimg &gt; img&#x27;).get_attribute(&quot;src&quot;)</span><br><span class="line">            # 获得网页的显示的图片宽度</span><br><span class="line">            htmlsize = self.driver.find_element_by_class_name(&#x27;JDJRV-bigimg&#x27;).size[&#x27;width&#x27;]</span><br><span class="line">            # 用来找到登录图片的小滑块</span><br><span class="line">            smallimg = self.driver.find_element_by_class_name(&#x27;JDJRV-smallimg &gt; img&#x27;).get_attribute(&quot;src&quot;)</span><br><span class="line">            # 背景大图命名</span><br><span class="line">            backimg = &quot;backimg.png&quot;</span><br><span class="line">            # 滑块命名</span><br><span class="line">            slideimg = &quot;slideimg.png&quot;</span><br><span class="line">            # 下载背景大图保存到本地</span><br><span class="line">            request.urlretrieve(bigimg, backimg)</span><br><span class="line">            # 下载滑块保存到本地</span><br><span class="line">            request.urlretrieve(smallimg, slideimg)</span><br><span class="line">            # 获取图片并灰度化</span><br><span class="line">            block = cv2.imread(slideimg, 0)</span><br><span class="line">            template = cv2.imread(backimg, 0)</span><br><span class="line">            # 获取下载下来大图的宽</span><br><span class="line">            bigsize = list(template.shape)[1]</span><br><span class="line">            # 获取下载下来滑块的宽</span><br><span class="line">            slidesize = list(block.shape)[1]</span><br><span class="line"></span><br><span class="line">            # 获得缩放比例</span><br><span class="line">            bili = htmlsize / bigsize</span><br><span class="line">            # print(bili)</span><br><span class="line">            # 二值化后的图片名称</span><br><span class="line">            blockName = &quot;block.jpg&quot;</span><br><span class="line">            templateName = &quot;template.jpg&quot;</span><br><span class="line">            # 将二值化后的图片进行保存</span><br><span class="line">            cv2.imwrite(blockName, block)</span><br><span class="line">            cv2.imwrite(templateName, template)</span><br><span class="line">            block = cv2.imread(blockName)</span><br><span class="line">            block = cv2.cvtColor(block, cv2.COLOR_RGB2GRAY)</span><br><span class="line">            block = abs(255 - block)</span><br><span class="line">            cv2.imwrite(blockName, block)</span><br><span class="line">            block = cv2.imread(blockName)</span><br><span class="line">            template = cv2.imread(templateName)</span><br><span class="line">            # 获取偏移量</span><br><span class="line">            result = cv2.matchTemplate(block, template,</span><br><span class="line">                                       cv2.TM_CCOEFF_NORMED)  # 查找block在template中的位置，返回result是一个矩阵，是每个点的匹配结果</span><br><span class="line">            # print(result)</span><br><span class="line">            x, y = np.unravel_index(result.argmax(), result.shape)</span><br><span class="line">            # print(&quot;x方向的偏移&quot;, int(y*bili), &#x27;x:&#x27;, x, &#x27;y:&#x27;, y)</span><br><span class="line">            # 获取滑块</span><br><span class="line">            element = self.driver.find_element_by_class_name(&#x27;JDJRV-smallimg &gt; img&#x27;)</span><br><span class="line">            Drag_the(element, y * bili, iframeLocal, WHH, slidesize * bili / 2)</span><br><span class="line">            time.sleep(3)</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    # 看是否需要短信验证</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            self.find(&quot;//a[text()=&#x27;短信验证&#x27;]&quot;).click()</span><br><span class="line">            tips(&#x27;需要短信验证，请手动完成后点击确定&#x27;)</span><br><span class="line">            break</span><br><span class="line">        except:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    while True:</span><br><span class="line">        if self.driver.title == &#x27;京东商城:商家后台&#x27;:</span><br><span class="line">            self.obvious_wait(&quot;//div[@aria-label=&#x27;公告提醒&#x27;]/button&quot;)  # 存在提示信息，点击关闭</span><br><span class="line">            self.obvious_wait(&quot;//div[@aria-label=&#x27;京麦提示&#x27;]/button&quot;)  # 存在提示信息，点击关闭</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3><span id="4-退出京东">4、退出京东</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">复制def logout_jd(self):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    注销京东账号</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # 使浏览器只剩一个窗口</span><br><span class="line">    for ind in self.driver.window_handles:</span><br><span class="line">        try:</span><br><span class="line">            self.driver.switch_to.window(self.driver.window_handles[1])</span><br><span class="line">            self.driver.close()</span><br><span class="line">            self.driver.switch_to.window(self.driver.window_handles[0])</span><br><span class="line">            time.sleep(1)</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">    self.driver.get(&#x27;https://shop.jd.com/&#x27;)</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            self.driver.find_element_by_xpath(&quot;//a[contains(text(), &#x27;退出&#x27;)]&quot;).click()</span><br><span class="line">            break</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1><span id="八-页面日期选择基本逻辑">八、页面日期选择基本逻辑</span></h1><h3><span id="1-京东商智-行业板块日期选择">1、京东商智-行业板块日期选择</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">复制# 按日选择-行业大盘 - 具体可参考app107行业板块下载代码</span><br><span class="line">def select_day_one(target_date):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    选择日期</span><br><span class="line">    :param target_date: 需要选择的日期</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    self.sure_click(&quot;//div[contains(text(), &#x27;查询（20&#x27;)]&quot;)</span><br><span class="line">    time.sleep(0.5)</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            self.find(&quot;//div[text()=&#x27;按天查询&#x27;]&quot;).click()</span><br><span class="line">            flag_date = self.find(&quot;//div[contains(@class, &#x27;er-day-p&#x27;)]/div[1]/span[3]&quot;).text</span><br><span class="line">            if flag_date[:4] &gt; target_date[:4]:</span><br><span class="line">                self.find(&quot;//div[contains(@class, &#x27;er-day-p&#x27;)]/div[1]/span[1]&quot;).click()</span><br><span class="line">            if flag_date[:4] &lt; target_date[:4]:</span><br><span class="line">                self.find(&quot;//div[contains(@class, &#x27;er-day-p&#x27;)]/div[1]/span[5]&quot;).click()</span><br><span class="line">            if flag_date[:4] == target_date[:4]:</span><br><span class="line">                if flag_date[5:7] &gt; target_date[5:7]:</span><br><span class="line">                    self.find(&quot;//div[contains(@class, &#x27;er-day-p&#x27;)]/div[1]/span[2]&quot;).click()</span><br><span class="line">                if flag_date[5:7] &lt; target_date[5:7]:</span><br><span class="line">                    self.find(&quot;//div[contains(@class, &#x27;er-day-p&#x27;)]/div[1]/span[4]&quot;).click()</span><br><span class="line">                if flag_date[5:7] == target_date[5:7]:</span><br><span class="line"></span><br><span class="line">                    if int(target_date[-2:]) &gt; 7:  # 月初，选择第一个</span><br><span class="line">                        self.driver.find_elements_by_xpath(</span><br><span class="line">                            &quot;//div[contains(@class, &#x27;er-day-p&#x27;)]//span[text()=&#x27;&#123;&#125;&#x27;]&quot;.format(</span><br><span class="line">                                int(target_date[-2:])))[0].click()</span><br><span class="line">                    else:  # 月末，选择最后一个</span><br><span class="line">                        self.driver.find_elements_by_xpath(</span><br><span class="line">                            &quot;//div[contains(@class, &#x27;er-day-p&#x27;)]//span[text()=&#x27;&#123;&#125;&#x27;]&quot;.format(</span><br><span class="line">                                int(target_date[-2:])))[-1].click()</span><br><span class="line"></span><br><span class="line">                    time.sleep(1)</span><br><span class="line">                    self.sure_click(&quot;//h3[text()=&#x27;行业大盘&#x27;]&quot;)</span><br><span class="line">                    if target_date in self.sure_text(&quot;//div[contains(text(), &#x27;查询（20&#x27;)]&quot;):</span><br><span class="line">                        break</span><br><span class="line">        except BaseException:</span><br><span class="line">            self.sure_click(&quot;//div[contains(text(), &#x27;查询（20&#x27;)]&quot;)</span><br><span class="line">            time.sleep(0.5)</span><br><span class="line"></span><br><span class="line"># 按月选择-行业大盘</span><br><span class="line">def select_month_one(target_date):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    选择月期</span><br><span class="line">    :param target_date: 需要选择的月期</span><br><span class="line">    :return:</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    self.sure_click(&quot;//div[contains(text(), &#x27;查询（20&#x27;)]&quot;)</span><br><span class="line">    time.sleep(0.5)</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            self.find(&quot;//div[text()=&#x27;按月查询&#x27;]&quot;).click()</span><br><span class="line">            flag_date = self.find(&quot;//div[contains(@class, &#x27;er-month-pa&#x27;)]/div[1]/span[2]&quot;).text</span><br><span class="line">            if flag_date[:-1] &gt; target_date[:4]:</span><br><span class="line">                self.find(&quot;//div[contains(@class, &#x27;er-month-pa&#x27;)]/div[1]/span[1]&quot;).click()</span><br><span class="line">            if flag_date[:-1] &lt; target_date[:4]:</span><br><span class="line">                self.find(&quot;//div[contains(@class, &#x27;er-month-pa&#x27;)]/div[1]/span[3]&quot;).click()</span><br><span class="line">            if flag_date[:-1] == target_date[:4]:</span><br><span class="line">                self.find(&quot;//div[contains(@class, &#x27;er-month-pa&#x27;)]//span[text()=&#x27;&#123;&#125;月&#x27;]&quot;.format(</span><br><span class="line">                    int(target_date[5:7]))).click()</span><br><span class="line"></span><br><span class="line">                time.sleep(1)</span><br><span class="line">                self.sure_click(&quot;//h3[text()=&#x27;行业大盘&#x27;]&quot;)</span><br><span class="line">                if target_date[:-2] + &#x27;01&#x27; in self.sure_text(&quot;//div[contains(text(), &#x27;查询（20&#x27;)]&quot;):</span><br><span class="line">                    break</span><br><span class="line"></span><br><span class="line">        except BaseException:</span><br><span class="line">            self.sure_click(&quot;//div[contains(text(), &#x27;查询（20&#x27;)]&quot;)</span><br><span class="line">            time.sleep(0.5)</span><br><span class="line"></span><br><span class="line">    self.sure_click(&quot;//h3[text()=&#x27;行业大盘&#x27;]&quot;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1><span id="九-图像识别验证码">九、图像识别（验证码）</span></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">复制# 下载库：pip install pytesseract </span><br><span class="line"># 下载相关应用安装到指定位置：https://digi.bib.uni-mannheim.de/tesseract/</span><br><span class="line"></span><br><span class="line">import pytesseract</span><br><span class="line">from PIL import Image</span><br><span class="line">pytesseract.pytesseract.tesseract_cmd = r&#x27;D:\自动化平台下载\汇尚RPA_TEST\汇尚RPA\brower\tesseract-OCR\tesseract.exe&#x27;  # 安装路径</span><br><span class="line"></span><br><span class="line"># 指定tesseract.exe的位置</span><br><span class="line"></span><br><span class="line">image = Image.open(&quot;D:\\自动化平台下载\\汇尚RPA_TEST\\汇尚RPA\\app\\appcode_1\验证码图片.png&quot;)</span><br><span class="line">text = pytesseract.image_to_string(image)</span><br><span class="line">print(text)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1><span id="十-网页事件封装">十、网页事件封装</span></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">复制class Automatic:</span><br><span class="line"></span><br><span class="line">    def __init__(self, driver):</span><br><span class="line">        self.driver = driver</span><br><span class="line">        self.action = ActionChains(self.driver)  # 鼠标事件</span><br><span class="line">        self.wait = WebDriverWait(driver, 3, 0.5)  # 显性等待事件</span><br><span class="line"></span><br><span class="line">    def find(self, xpath, obj=None):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        寻找元素，不一定有，常用来做日期选择，返回element对象</span><br><span class="line">        :param obj: 需要进行查找点击的前置对象,默认为self.driver</span><br><span class="line">        :param xpath:</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        if not obj:</span><br><span class="line">            obj = self.driver</span><br><span class="line">        return obj.find_element_by_xpath(xpath)</span><br><span class="line"></span><br><span class="line">    def mouse_hover(self, xpath):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        鼠标悬停事件，无返回对象</span><br><span class="line">        :param xpath: 可填入xpath对应的字符串，或者element对象</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        self.action = ActionChains(self.driver)</span><br><span class="line">        if isinstance(xpath, basestring):</span><br><span class="line">            self.action.move_to_element(self.find(xpath)).perform()</span><br><span class="line">        else:</span><br><span class="line">            self.action.move_to_element(xpath).perform()</span><br><span class="line"></span><br><span class="line">    def sure_click(self, xpath, obj=None):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        一定要点击的元素，无返回对象</span><br><span class="line">        :param obj: 需要进行查找点击的前置对象,默认为self.driver</span><br><span class="line">        :param xpath:</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        time_start = time.time()</span><br><span class="line"></span><br><span class="line">        if not obj:</span><br><span class="line">            obj = self.driver</span><br><span class="line">        while True:</span><br><span class="line">            try:</span><br><span class="line">                obj.find_element_by_xpath(xpath).click()</span><br><span class="line">                break</span><br><span class="line">            except BaseException:</span><br><span class="line">                if (time.time() - time_start) &gt; 10:</span><br><span class="line">                    raise Exception(&quot;响应超时&quot;)</span><br><span class="line">                pass</span><br><span class="line"></span><br><span class="line">    def slide_click(self, xpath, obj=None):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        滑动点击</span><br><span class="line">        :param obj: 需要进行查找点击的前置对象,默认为self.driver</span><br><span class="line">        :param xpath:</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        time_start = time.time()</span><br><span class="line"></span><br><span class="line">        if not obj:</span><br><span class="line">            obj = self.driver</span><br><span class="line">        while True:</span><br><span class="line">            try:</span><br><span class="line">                ele = obj.find_element_by_xpath(xpath)</span><br><span class="line">                self.driver.execute_script(&quot;arguments[0].scrollIntoView();&quot;, ele)</span><br><span class="line">                js = &quot;window.scrollBy(0,-500)&quot;</span><br><span class="line">                self.driver.execute_script(js)</span><br><span class="line">                ele.click()</span><br><span class="line">                break</span><br><span class="line">            except BaseException:</span><br><span class="line">                if (time.time() - time_start) &gt; 20:</span><br><span class="line">                    raise Exception(&quot;响应超时&quot;)</span><br><span class="line">                pass</span><br><span class="line"></span><br><span class="line">    def sure_text(self, xpath, obj=None):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        一定要得到的元素值，返回文本内容</span><br><span class="line">        :param obj: 需要进行查找点击的前置对象,默认为self.driver</span><br><span class="line">        :param xpath:</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        if not obj:</span><br><span class="line">            obj = self.driver</span><br><span class="line">        while True:</span><br><span class="line">            try:</span><br><span class="line">                text = obj.find_element_by_xpath(xpath).text</span><br><span class="line">                if not text:</span><br><span class="line">                    text = obj.find_element_by_xpath(xpath).get_attribute(&quot;textContent&quot;)</span><br><span class="line">                    if not text:</span><br><span class="line">                        text = obj.find_element_by_xpath(xpath).get_attribute(&quot;value&quot;)</span><br><span class="line">                if text:</span><br><span class="line">                    return text</span><br><span class="line">            except BaseException:</span><br><span class="line">                pass</span><br><span class="line"></span><br><span class="line">    def find_text(self, xpath, obj=None):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        查找元素的文本内容，可能会查找不到</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        if not obj:</span><br><span class="line">            obj = self.driver</span><br><span class="line">        try:</span><br><span class="line">            return obj.find_element_by_xpath(xpath).text</span><br><span class="line">        except BaseException:</span><br><span class="line">            return &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">    def obvious_wait(self, xpath):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        显性等待事件，用来处理可能出现的点击事件，无返回对象</span><br><span class="line">        :param xpath:</span><br><span class="line">        :return:</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        try:</span><br><span class="line">            self.wait.until(lambda x: x.find_element_by_xpath(xpath)).click()</span><br><span class="line">        except BaseException:</span><br><span class="line">            pass</span><br></pre></td></tr></table></figure>
      </section>

      
      
        <nav class="article-nav">
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2024/10/04/TKGUI/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">TKGUI</h2>
        </a>
      
      <div class="card-text--row">Newer</div>
    </div>
  </article>
</div>
          
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2024/10/04/Python%E7%9A%84Excel%E8%87%AA%E5%8A%A8%E5%8C%96/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">Python的Excel自动化</h2>
        </a>
      
      <div class="card-text--row">Older</div>
    </div>
  </article>
</div>
          
        </nav>
      

      <section class="page-message-container layout-padding">
        


  
  

  
  


      </section>
    </div>
    <div class="widget-info">
      <section class="widget-author widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-body">
    
      <img src="https://img.tukuppt.com/ad_preview/00/83/15/jmLqkl3XWx.jpg!/fw/260" class="soft-size--round soft-style--box" alt="ChengZhou">
    
    
      <h2>ChengZhou</h2>
    
    
      <p>贵在坚持</p>
    

    <div class="count-box">
      <div class="count-box--item">
        <svg class="icon icon-article" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M240.51564747 647.74217627h196.07203239c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806V165.10332731c0-33.18142087-30.16492806-60.32985613-60.32985612-60.32985611H245.04038668C225.43318342 104.7734712 210.35071939 119.85593522 210.35071939 139.46313845V617.57724821c0 16.59071043 13.57421762 30.16492806 30.16492808 30.16492806z m663.62841731-452.47392089v482.63884894c0 33.18142087-27.14843525 60.32985613-60.32985612 60.32985613H180.18579134c-33.18142087 0-60.32985613-27.14843525-60.32985612-60.32985613V195.26825538c-49.77213131 0-90.49478418 40.72265287-90.49478417 90.49478417v452.4739209c0 49.77213131 40.72265287 90.49478418 90.49478417 90.49478417h286.56681657c16.59071043 0 30.16492806 13.57421762 30.16492807 30.16492807s13.57421762 30.16492806 30.16492805 30.16492806h90.49478418c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806s13.57421762-30.16492806 30.16492807-30.16492807h286.56681657c49.77213131 0 90.49478418-40.72265287 90.49478417-90.49478417V285.76303955c0-49.77213131-40.72265287-90.49478418-90.49478417-90.49478417zM587.41232014 647.74217627h191.54729318c19.60720323 0 34.68966726-15.08246403 34.68966729-34.68966727V134.93839925c0-16.59071043-13.57421762-30.16492806-30.16492808-30.16492805H617.57724821c-30.16492806 0-60.32985613 27.14843525-60.32985612 60.32985611v452.4739209c0 16.59071043 13.57421762 30.16492806 30.16492805 30.16492806z" fill="currentColor"></path>
</svg>
        <span>20</span>
      </div>
      <div class="count-box--item">
        <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
        0
      </div>
      <div class="count-box--item">
        <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
        17
      </div>
    </div>
  </div>
</section>

      

      
<section class="widet-notice widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-notice" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M512 945.02305225v28.15620663a24.27259221 24.27259221 0 0 1-24.27259221 24.27259335H394.0352a48.54518557 48.54518557 0 0 1-41.74885888-23.78714112l-110.68302222-184.47170332a132.04290333 132.04290333 0 0 1-17.47626667-48.54518557h118.4502511a200.97706667 200.97706667 0 0 1 76.21594113 14.56355556l20.38897777 133.49925888a48.54518557 48.54518557 0 0 0 36.40888888 27.67075555l16.01991111 2.91271112a24.27259221 24.27259221 0 0 1 20.38897778 25.72894889zM997.45185223 463.45481443a194.18074112 194.18074112 0 0 1-38.8361489 116.50844445 24.75804445 24.75804445 0 0 1-36.4088889 0l-34.95253333-34.95253333a24.27259221 24.27259221 0 0 1-2.91271111-30.58346667 97.09036999 97.09036999 0 0 0 0-106.79940665 24.27259221 24.27259221 0 0 1 2.91271111-30.58346666l34.95253333-34.95253334a24.75804445 24.75804445 0 0 1 18.93262223-7.28177777 26.2144 26.2144 0 0 1 17.47626667 9.70903665A194.18074112 194.18074112 0 0 1 997.45185223 463.45481443z m-194.18074112-388.36148111v776.72296335a48.54518557 48.54518557 0 0 1-48.54518556 48.54518443h-28.64165888a48.54518557 48.54518557 0 0 1-33.98163001-14.07810332l-145.63555556-143.20829668A291.27111111 291.27111111 0 0 0 342.57730333 657.63555556H172.18370333a145.63555556 145.63555556 0 0 1-145.63555556-145.63555556v-97.09036999a145.63555556 145.63555556 0 0 1 145.63555556-145.63555556h170.3936a291.27111111 291.27111111 0 0 0 206.31703779-85.43952668l145.63555555-143.20829554a48.54518557 48.54518557 0 0 1 33.98162888-14.07810446H754.72592555a48.54518557 48.54518557 0 0 1 48.54518556 48.54518555z" fill="currentColor"></path>
</svg>
    <span>NOTICE</span>
  </div>
  <div class="widget-body">
    <p>学习中。。。</p>
  </div>
</section>


      <section class="widget-categories widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
      <span>CATEGORIES</span>
  </div>
  <div class="widget-body">
    <ul class="categories-list">
      
    </ul>
  </div>
</section>

      <section class="widget-tags widget-item  layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
    <span>TAGS</span>
  </div>
  <div class="widget-body">
    <div class="tags-cloud">
      <a href="/tags/Django/" style="font-size: 10px;" class="tags-cloud-0">Django</a> <a href="/tags/Django-Linux/" style="font-size: 10px;" class="tags-cloud-0">Django Linux</a> <a href="/tags/Excel%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size: 10px;" class="tags-cloud-0">Excel自动化</a> <a href="/tags/Flask/" style="font-size: 10px;" class="tags-cloud-0">Flask</a> <a href="/tags/Linux-Mysql/" style="font-size: 10px;" class="tags-cloud-0">Linux Mysql</a> <a href="/tags/Python/" style="font-size: 10px;" class="tags-cloud-0">Python</a> <a href="/tags/Python-Mysql/" style="font-size: 10px;" class="tags-cloud-0">Python Mysql</a> <a href="/tags/Redis/" style="font-size: 10px;" class="tags-cloud-0">Redis</a> <a href="/tags/TkGUI/" style="font-size: 10px;" class="tags-cloud-0">TkGUI</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" style="font-size: 10px;" class="tags-cloud-0">博客搭建</a> <a href="/tags/%E5%AE%B9%E5%99%A8%E9%83%A8%E7%BD%B2/" style="font-size: 20px;" class="tags-cloud-10">容器部署</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;" class="tags-cloud-0">数据结构</a> <a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size: 10px;" class="tags-cloud-0">浏览器自动化</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 10px;" class="tags-cloud-0">爬虫</a> <a href="/tags/%E7%BD%91%E9%A1%B5%E5%B8%83%E5%B1%80/" style="font-size: 10px;" class="tags-cloud-0">网页布局</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size: 15px;" class="tags-cloud-5">自动化</a> <a href="/tags/%E9%A1%B9%E7%9B%AE%E8%AE%B0%E5%BD%95/" style="font-size: 10px;" class="tags-cloud-0">项目记录</a>
    </div>
  </div>
</section>
    </div>
  </article>
</div>

    <!-- footer container -->
<footer id="footer" class="footer">
  <div class="footer-container">
    
    <div class="social-icons">
      
        
      
        
      
        
      
        
          <a href="https://github.com/Xiaozhou-h" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
</svg>
          </a>
        
      
        
          <a href="https://github.com/Xiaozhou-h" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-twitter" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M962.285714 233.142857q-38.285714 56-92.571429 95.428571 0.571429 8 0.571429 24 0 74.285714-21.714286 148.285714t-66 142-105.428571 120.285714-147.428571 83.428571-184.571429 31.142857q-154.857143 0-283.428571-82.857143 20 2.285714 44.571429 2.285714 128.571429 0 229.142857-78.857143-60-1.142857-107.428571-36.857143t-65.142857-91.142857q18.857143 2.857143 34.857143 2.857143 24.571429 0 48.571429-6.285714-64-13.142857-106-63.714286t-42-117.428571l0-2.285714q38.857143 21.714286 83.428571 23.428571-37.714286-25.142857-60-65.714286t-22.285714-88q0-50.285714 25.142857-93.142857 69.142857 85.142857 168.285714 136.285714t212.285714 56.857143q-4.571429-21.714286-4.571429-42.285714 0-76.571429 54-130.571429t130.571429-54q80 0 134.857143 58.285714 62.285714-12 117.142857-44.571429-21.142857 65.714286-81.142857 101.714286 53.142857-5.714286 106.285714-28.571429z"></path>
</svg>
          </a>
        
      
    </div>
     
    <p>&copy; 2024 <a href="/" target="_blank">ChengZhou</a></p>

    

    <p>Powered by <a href="https://hexo.io" target="_blank" rel="noopener noreferrer">Hexo</a> Theme - <a href="https://github.com/miiiku/flex-block" target="_blank" rel="noopener noreferrer author">flex-block</a></p>

    <p>
      <a href="javascript:;" id="theme-light">🌞 浅色</a>
      <a href="javascript:;" id="theme-dark">🌛 深色</a>
      <a href="javascript:;" id="theme-auto">🤖️ 自动</a>
    </p>
  </div>
</footer>
  </div>

  <div class="back-to-top-fixed soft-size--round soft-style--box">
    <svg class="icon icon-back-to-top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <path d="M725.333333 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l213.333333 213.333333c17.066667 17.066667 17.066667 42.666667 0 59.733333C746.666667 422.4 738.133333 426.666667 725.333333 426.666667z"></path>
      <path d="M298.666667 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l213.333333-213.333333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333333C320 422.4 311.466667 426.666667 298.666667 426.666667z"></path>
      <path d="M512 896c-25.6 0-42.666667-17.066667-42.666667-42.666667L469.333333 170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667l0 682.666667C554.666667 878.933333 537.6 896 512 896z"></path>
    </svg>
  </div>

  
  






<!-- copy button  -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script>

<!-- https://clipboardjs.com/ -->










  


  


  




<script src="/js/script.js"></script>


  
  <!-- 尾部用户自定义相关内容 -->
</body>
</html>
